(()=>{"use strict";function e(e){e&&document.querySelector(e.selector).addEventListener("click",(function(){var t=document.querySelector(e.input),s="";switch(e.input){case"#wdss-jsonld-schema-orgname input":s=wdss_localize.site_name;break;case"#wdss-jsonld-schema-email input":s=wdss_localize.site_email}t.value=s}))}var t=function(e,t){setTimeout((function(){e.remove()}),t)};function s(e){var t=document.querySelector(e.toggler),s=t.hasAttribute("checked"),o=document.querySelector(e.target);s&&o.classList.toggle("hidden"),t.addEventListener("click",(function(){o.classList.toggle("hidden")}))}function o(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];t.forEach((function(e){Array.from(document.querySelectorAll(e.button)).forEach((function(t){t.addEventListener("click",(function(){var s=t.closest("div").querySelector(e.target);""!==s.value&&confirm("Are you sure?")&&(s.value="")}))}))}))}var c={toggler:"#wdss-auto-featured-image-condition input",target:"#wdss-featured-images-group"},n={toggler:"#wdss-polylang-meta-data-condition input",target:"#wdss-polylang-meta-data-group"},a={button:"#wdss-featured-images-group button.reset",target:"#wdss-featured-images-group input"},r={button:"#wdss-jsonld-schema-logo button.reset",target:"#wdss-jsonld-schema-logo input"},i={select:".image-chooser.featured button.choose",target:".image-chooser.featured input",is_multiple:!0,title:"Select Featured Images"},l={select:".image-chooser.logo button.choose",target:".image-chooser.logo input",is_multiple:!1,title:"Select Organization Logo"},d={selector:"#wdss-generate-orgname",input:"#wdss-jsonld-schema-orgname input"},u={selector:"#wdss-generate-email",input:"#wdss-jsonld-schema-email input"},m={root_el:"#custom-410s-list-settings",action:"e410_dictionary_update",nonce:"e410-dictionary-nonce",name:"e410_dictionary"},f={root_el:"#images-settings",action:"excluded_hosts_dictionary_update",nonce:"excluded-hosts-dictionary-nonce",name:"excluded_hosts_dictionary"};function g(e){Array.from(document.querySelectorAll(e.select)).forEach((function(t){t.addEventListener("click",(function(s){var o;s.preventDefault(),(o=wp.media({title:e.title,multiple:e.is_multiple,library:{type:"image"},button:{text:"Select"}})).on("close",(function(){var s=t.closest(".image-chooser.featured"),c=t.closest(".image-chooser.logo"),n=o.state().get("selection"),a=new Array,r=new Array,i=0;if(s){n.forEach((function(e){a[i]=e.id,i++}));var l=a.join(",");s.querySelector(e.target).value=l}else if(c){n.forEach((function(e){r[i]=e.attributes.url,i++}));var d=r.join(",");c.querySelector(e.target).value=d}})),o.on("open",(function(){var s=t.closest(".wdss-setting-item.image-chooser"),c=o.state().get("selection");s.querySelector(e.target).value.split(",").forEach((function(e){var t=wp.media.attachment(e);t.fetch(),c.add(t?[t]:[])}))})),o.open()}))}))}function v(){var e=document.querySelector("html"),t=document.querySelector("#wdss-remove-broken-featured__choose"),s=document.querySelector(".wdss-modal-header i.fa-times"),o=document.querySelector(".wdss-modal"),c=o.querySelector("table"),n=document.querySelector("#wdss-exclude-posts-table tbody"),a=o.querySelector(".wdss-button.submit"),r=o.querySelector(".wdss-button.toggle-all"),i=o.querySelector(".wdss-button.get-posts"),l=o.querySelector(".wdss-modal-welcome-msg");function d(){o.classList.remove("active"),e.classList.remove("fixed")}function u(e){this.insertAdjacentHTML("beforeend",e);var t=document.querySelector(".wdss-modal-loading-msg");t&&t.remove();var s=Array.from(document.querySelectorAll(".wdss-table-row.post"));function n(e){e.setAttribute("checked","checked"),e.checked=!0}function l(e){e.removeAttribute("checked"),e.checked=!1}console.log("Found ".concat(s.length," posts")),s.length>0?(s.forEach((function(e){e.addEventListener("click",(function(){var t=e.querySelector('.wdss-table-post__select input[type="checkbox"]');t.hasAttribute("checked")?l(t):n(t)}))})),i.classList.add("inactive"),a.classList.remove("inactive"),r.classList.remove("inactive"),r.addEventListener("click",(function(e){e.currentTarget.params.forEach((function(e){var t=e.querySelector('.wdss-table-post__select input[type="checkbox"]');t.hasAttribute("checked")?l(t):n(t)}))})),r.params=s):c.insertAdjacentHTML("afterend",'<span class="wdss-modal-not-found-msg">No results...</span>'),a.addEventListener("click",(function(){var e,t=o.querySelectorAll('.wdss-table-post__select input[type="checkbox"]:checked'),s=[];0!==t.length?(i.classList.remove("inactive"),t.forEach((function(e){s.push(e.value)})),e=s.join(","),Array.from(o.querySelectorAll(".wdss-table-row.post")).forEach((function(e){e.parentNode.removeChild(e)})),i.classList.remove("inactive"),a.classList.add("inactive"),r.classList.add("inactive"),jQuery.ajax({url:wdss_localize.url,type:"post",data:{selected_list:JSON.stringify(e),action:"remove_broken_featured",security:wdss_localize.remove_broken_featured_nonce},success:function(e){console.log("Completed!")},error:function(e){alert("Error!"),console.log(e)}})):i.classList.add("inactive")}))}o.querySelector(".wdss-modal-header").insertAdjacentHTML("afterbegin",'<span class="wdss-modal-title">Delete Broken Featured Images</span>'),t.addEventListener("click",(function(){o.classList.add("active"),e.classList.add("fixed")})),s.addEventListener("click",d),document.onkeydown=function(e){return"Esc"===e.key||"Escape"===e.key?d():null},i.addEventListener("click",(function(){i.classList.add("inactive"),l.classList.remove("active"),c.insertAdjacentHTML("afterend",'<span class="wdss-modal-loading-msg">Loading...</span>');var e=[],t=o.querySelector(".wdss-modal-not-found-msg");t&&t.remove();var s=wdss_localize.total_post_count,a=Math.ceil(s/100),r=[];console.log("Total pages: ".concat(a));for(var d=function(t){console.log("Loop #: ".concat(t));var s=new Promise((function(s,o){jQuery.ajax({url:document.location.origin+"/wp-json/wp/v2/posts?orderby=id&order=asc&per_page=100&page=".concat(t),type:"get",success:function(t){e=e.concat(t),s()},error:function(e){alert("Error!"),console.log(e),o()}})}));r.push(s)},m=1;m<=a;m++)d(m);Promise.all(r).then((function(t){jQuery.ajax({url:wdss_localize.url,type:"post",data:{posts_list:JSON.stringify(e),action:"fetch_broken_featured",security:wdss_localize.broken_featured_list_nonce},success:function(e){u.call(n,e)}})}))}))}function p(e){var s=document.querySelector(e.root_el),o=s.querySelector(".wdss-list-item-handler.add"),c=s.querySelector(".save-dictionary"),n=document.querySelector("#wdss-settings-page form"),a=s.querySelector(".wdss-list-table tbody"),r=s.querySelector('input[type="text"]'),i=jQuery("".concat(e.root_el," .wdss-list-table tbody tr")),l=[];jQuery.each(i,(function(){l.push(this.id)})),c.addEventListener("click",(function(){var o=jQuery("".concat(e.root_el," .wdss-list-table tbody tr")),n=[];o.each((function(e,t){var s=t.querySelector("td:nth-of-type(1)").textContent;n.push(s)}));var a={action:e.action,security:e.nonce};a[e.name]=n,jQuery.ajax({url:wdss_localize.url,type:"post",dataType:"json",data:a,success:function(e){var o=s.querySelector(".wdss-list-table-actions span");o&&o.remove(),c.insertAdjacentHTML("afterend",'<span class="msg successful">Table was updated</span>'),t(s.querySelector("span.msg"),1200),c.classList.add("saved")},fail:function(e){var o=s.querySelector(".wdss-list-table-actions span");o&&o.remove(),c.insertAdjacentHTML("afterend",'<span class="msg error">Error, look at information in console</span>'),t(s.querySelector("span.msg"),1200),console.log(e)}})})),o.addEventListener("click",(function(){if(r.value){c.classList.remove("saved");var e=r.value;r.value="",a.insertAdjacentHTML("beforeend",'\n      <tr id="'.concat(wdss_localize.wp_rand,'">\n        <td>').concat(e,'</td>\n        <td class="wdss-list-table__remove-item"><i class="fas fa-trash"></i></td>\n      </tr>\n      '))}})),jQuery(document).on("click","".concat(e.root_el," .wdss-list-table__remove-item i"),(function(){c.classList.remove("saved"),confirm("Remove this rule from table?")&&this.closest("tr").remove()})),n.addEventListener("submit",(function(t){var s,o=jQuery("".concat(e.root_el," .wdss-list-table tbody tr")),n=[];jQuery.each(o,(function(){n.push(this.id)})),function(e,t){if(e.length!==t.length)return!1;for(var s=0;s<e.length;s++)if(!t.includes(e[s]))return!1;return!0}(l,n)&&(s=!0),s||c.classList.contains("saved")||confirm("All unsaved changes will be lost. Do you want to continue?")||t.preventDefault()}))}var y=document.querySelector("#wdss-settings-page");document.addEventListener("DOMContentLoaded",(function(){var t,h,S;y&&(document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings) > .wdss-row").forEach((function(e){e.classList.contains("pinned")||e.classList.add("hidden");var t=e.previousElementSibling,s=t.querySelectorAll(".section-toggler");function o(){t.classList.toggle("active"),e.classList.toggle("hidden")}s&&s.forEach((function(e){e.addEventListener("click",o)}))})),function(){var e=document.querySelectorAll(".wdss-section .section-pin"),t=document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings)");function s(){var e,t,s,o=this.closest(".wdss-section-header"),c=o.closest(".wdss-section").getAttribute("id");(JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[]).includes(c)?(this.classList.remove("active"),o.querySelector("h2").classList.remove("pinned"),o.querySelector("i.section-toggler").classList.remove("disabled"),e=c,-1!==(s=(t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[]).indexOf(e))&&t.splice(s,1),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))):(this.classList.add("active"),o.classList.add("active"),function(e){var t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[];t.push(e),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))}(c),o.querySelector("h2").classList.add("pinned"),o.querySelector("i.section-toggler").classList.add("disabled"))}!function(){var e;localStorage.getItem("PINNED_WDS_SECTIONS")?e=localStorage.getItem("PINNED_WDS_SECTIONS"):(e=[],localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(e)));var s=e;t.forEach((function(e){var t=e.getAttribute("id"),o=e.querySelector(".wdss-section-header"),c=o.nextElementSibling;s.includes(t)&&(e.classList.add("pinned"),o.querySelector("i.section-pin").classList.add("active"),o.querySelector("i.section-toggler").classList.add("disabled"),o.classList.add("active"),o.querySelector("h2").classList.add("pinned"),c.classList.remove("hidden"))}))}(),e.forEach((function(e){e.addEventListener("click",s)}))}(),wdss_localize.total_post_count>0&&(s(c),e(d),g(i),o(a),v()),wdss_localize.is_polylang_exists&&wdss_localize.is_polylang_setup&&s(n),p(m),p(f),g(l),o(r),t=document.querySelector("#wdss-advanced-jsonld-schema-condition input"),h=document.querySelector(".wdss-jsonld-schema-predifined-settings"),t.hasAttribute("checked")&&h.classList.add("disabled"),t.addEventListener("click",(function(){h.classList.contains("disabled")?h.classList.remove("disabled"):h.classList.add("disabled")})),e(u),Array.from(document.querySelectorAll('input[type="checkbox"')).forEach((function(e){e.addEventListener("click",(function(){e.hasAttribute("checked")?(e.removeAttribute("checked"),e.value=0,e.checked=!1):(e.setAttribute("checked","checked"),e.checked=!0,e.value=1)}))})),S=Array.from(document.querySelectorAll("#wdss-snippets-settings input")),document.querySelector("#wdss-toggle-options").addEventListener("click",(function(){S[0].hasAttribute("checked")?S.forEach((function(e){e.removeAttribute("checked"),e.checked=!1})):S.forEach((function(e){e.setAttribute("checked","checked"),e.checked=!0}))})),Array.from(document.querySelectorAll(".wdss-setting-item-accordion")).forEach((function(e){var t=e.nextElementSibling;e.addEventListener("click",(function(){t.classList.contains("active")?(e.classList.remove("opened"),t.classList.remove("active")):(e.classList.add("opened"),t.classList.add("active"))}))})))}))})();