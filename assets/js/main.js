(()=>{"use strict";function e(e,t,n,o,s,c,i){try{var a=e[c](i),r=a.value}catch(e){return void n(e)}a.done?t(r):Promise.resolve(r).then(o,s)}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n=function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}var o,s,c,i,a;return o=n,s=[{key:"confirm",value:(i=regeneratorRuntime.mark((function e(t){var o,s,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.template(t,"confirm"),o=document.querySelector(".notification-content-inputs"),s=o.querySelector("button.confirm"),c=o.querySelector("button.cancel"),i=new Promise((function(e){s.addEventListener("click",(function(){e(!0),n.closeNotification(o)})),c.addEventListener("click",(function(){e(!1),n.closeNotification(o)}))})),e.next=7,i;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})),a=function(){var t=this,n=arguments;return new Promise((function(o,s){var c=i.apply(t,n);function a(t){e(c,o,s,a,r,"next",t)}function r(t){e(c,o,s,a,r,"throw",t)}a(void 0)}))},function(e){return a.apply(this,arguments)})},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.template(e,"info",t)}},{key:"prompt",value:function(e,t){n.template(e,"prompt");var o=document.querySelector(".notification-content-inputs"),s=o.querySelector("input"),c=o.querySelector("button");s.value&&c.addEventListener("click",(function(){t(s.value),n.closeNotification(o)}))}}],c=[{key:"closeNotification",value:function(e,t,n){var o=n?n.includes("wdss-modal"):null,s=document.querySelector("html");e.closest(".notification")&&e.closest(".notification").remove(),("prompt"===t||o)&&s.classList.remove("fixed")}},{key:"template",value:function(e,t,o){var s,c,i=document.querySelector("html");switch(document.onkeydown=function(e){return"Esc"===e.key||"Escape"===e.key?n.closeNotification(document.querySelector(".modal.notification")):null},t){default:c="info";break;case"prompt":c="prompt";break;case"confirm":c="confirm"}if(s='\n\t\t\t\t<div class="modal notification '.concat(c,'">\n\t\t\t\t<div class="notification-header">\n\t\t\t\t\t<i class="fas fa-times"></i>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-content">\n\t\t\t\t<span>').concat(e,"</span>\n\t\t\t\t</div>"),"prompt"===t?(i.classList.add("fixed"),s+='<div class="notification-content-inputs"><input required type="number" min="50" value="50"><button type="button" class="wdss-button">Enter</button></div>'):"confirm"===t&&(s+='<div class="notification-content-inputs"><button class="wdss-button confirm">Yes</button><button class="wdss-button cancel">No</button></div>'),s+="</div>",document.body.insertAdjacentHTML("beforeend",s),document.querySelector(".notification-header i")){var a=document.querySelector(".notification-header i");a.addEventListener("click",(function(){n.closeNotification(a,t,o)}))}}}],s&&t(o.prototype,s),c&&t(o,c),n}(),o=new n,s=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!t.includes(e[n]))return!1;return!0};function c(e){e&&document.querySelector(e.selector)&&document.querySelector(e.selector).addEventListener("click",(function(){var t=document.querySelector(e.input),n="";switch(e.input){case"#wdss-jsonld-schema-orgname input":n=wdss_localize.site_name;break;case"#wdss-jsonld-schema-email input":n=wdss_localize.site_email}t.value=n}))}var i=function(e,t){setTimeout((function(){e.remove()}),t)};function a(e){var t=document.querySelector(e.toggler),n=t.hasAttribute("checked"),o=document.querySelector(e.target);n&&o.classList.toggle("hidden"),t.addEventListener("click",(function(){o.classList.toggle("hidden")}))}function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){Array.from(document.querySelectorAll(e.button)).forEach((function(t){t.addEventListener("click",(function(){var n=t.closest("div").querySelector(e.target);""!==n.value&&o.confirm("Are you sure?").then((function(e){!0===e&&(n.value="")}))}))}))}))}function l(e){e.setAttribute("checked","checked"),e.checked=!0}var d={toggler:"#wdss-auto-featured-image-condition input",target:"#wdss-featured-images-group"},u={toggler:"#wdss-polylang-meta-data-condition input",target:"#wdss-polylang-meta-data-group"},f={button:"#wdss-featured-images-group button.reset",target:"#wdss-featured-images-group input"},m={button:"#wdss-jsonld-schema-logo button.reset",target:"#wdss-jsonld-schema-logo input"},v={select:".image-chooser.featured button.choose",target:".image-chooser.featured input",is_multiple:!0,title:"Select Featured Images"},p={select:".image-chooser.logo button.choose",target:".image-chooser.logo input",is_multiple:!1,title:"Select Organization Logo"},h={selector:"#wdss-generate-orgname",input:"#wdss-jsonld-schema-orgname input"},g={selector:"#wdss-generate-email",input:"#wdss-jsonld-schema-email input"},_={root_el:"#custom-410s-list-settings",action:"e410_dictionary_update",nonce:"e410-dictionary-nonce",name:"e410_dictionary"},y={root_el:"#post-content-settings",action:"excluded_hosts_dictionary_update",nonce:"excluded-hosts-dictionary-nonce",name:"excluded_hosts_dictionary"},w={modal_el:"#exclude-posts-modal",modal_title:"Delete Broken Featured Images",open_modal_btn:"#wdss-remove-broken-featured__choose",fetch_action:"fetch_broken_featured",fetch_nonce_name:"fetch_broken_featured_nonce",fetch_nonce_value:wdss_localize.broken_featured_list_nonce,post_action:"remove_broken_featured",post_nonce_name:"remove_broken_featured_nonce",post_nonce_value:wdss_localize.remove_broken_featured_nonce},b={modal_el:"#fix-validation-posts-modal",modal_title:"Fix Posts Validation Errors",open_modal_btn:"#wdss-fix-validation-errors__choose",fetch_action:"fetch_all_posts",fetch_nonce_name:"unvalidated_posts_list_nonce",fetch_nonce_value:wdss_localize.unvalidated_posts_list_nonce,post_action:"fix_posts_validation_errors",post_nonce_name:"fix-posts-validation-errors-nonce",post_nonce_value:wdss_localize.fix_posts_validation_errors_nonce};function S(e){Array.from(document.querySelectorAll(e.select)).forEach((function(t){t.addEventListener("click",(function(n){var o;n.preventDefault(),(o=wp.media({title:e.title,multiple:e.is_multiple,library:{type:"image"},button:{text:"Select"}})).on("close",(function(){var n=t.closest(".image-chooser.featured"),s=t.closest(".image-chooser.logo"),c=o.state().get("selection"),i=new Array,a=new Array,r=0;if(n){c.forEach((function(e){i[r]=e.id,r++}));var l=i.join(",");n.querySelector(e.target).value=l}else if(s){c.forEach((function(e){a[r]=e.attributes.url,r++}));var d=a.join(",");s.querySelector(e.target).value=d}})),o.on("open",(function(){var n=t.closest(".wdss-setting-item.image-chooser"),s=o.state().get("selection");n.querySelector(e.target).value.split(",").forEach((function(e){var t=wp.media.attachment(e);t.fetch(),s.add(t?[t]:[])}))})),o.open()}))}))}function L(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function q(e,t,n,o,s,c,i){try{var a=e[c](i),r=a.value}catch(e){return void n(e)}a.done?t(r):Promise.resolve(r).then(o,s)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(o,s){var c=e.apply(t,n);function i(e){q(c,o,s,i,a,"next",e)}function a(e){q(c,o,s,i,a,"throw",e)}i(void 0)}))}}wdss_localize.reset_posts_validation_status,wdss_localize.reset_posts_validation_status_nonce;var A=new n;function x(e){var t=document.querySelector("html"),n=document.querySelector(e.modal_el),o=document.querySelector(e.open_modal_btn),s=n.querySelector(".wdss-modal-header i.fa-times"),c=wdss_localize.total_post_count,i=Math.ceil(c/50);window["".concat(e.fetch_action,"-setup")]=!0,o&&o.addEventListener("mousedown",(function(){var o,a,r=n.querySelector(".wdss-modal-body"),d=n.querySelector(".wdss-modal-informaion-panel"),u=n.querySelector("tbody"),f=n.querySelector(".wdss-button.submit"),m=n.querySelector(".wdss-button.toggle-all"),v=n.querySelector(".wdss-button.get-posts"),p=n.querySelector(".wdss-modal-posts-count"),h=p.querySelector("strong"),g=n.querySelector(".wdss-modal-welcome-msg"),_='<span class="wdss-modal-not-found-msg">No results...</span>',y='<span class="msg error">An Error occured!<br><smallLook in console for more details</small></span>',w=n.querySelector(".wdss-modal-title"),b=e.modal_title,S=[],k=!1;function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e&&e.length>0&&d.classList.remove("active"),!e){var t=n.querySelector(".wdss-modal-not-found-msg");t&&t.remove()}}function x(){n.classList.remove("active"),t.classList.remove("fixed"),Array.from(document.querySelectorAll(".notification")).forEach((function(e){e.remove()}))}function j(){return Array.from(document.querySelectorAll(".wdss-table-row.post"))}function N(){var e=j().length;if(p.classList.add("active"),h)return h.innerHTML=e}function T(){j().forEach((function(e){l(e.querySelector('.wdss-table-post__select input[type="checkbox"]'))}))}function I(){return(I=E(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(){for(var e=[],t=function(t){try{e.push(new Promise((function(e,n){fetch(document.location.origin+"/wp-json/wp/v2/posts/?per_page=50&page=".concat(t)).then((function(e){return e.json()})).then((function(t){var n;console.log(t),S=(n=S).concat.apply(n,L(t)),e()})).catch((function(e){console.log(e),n()}))})))}catch(e){return"break"}},n=1;n<=window.next_fetched_page&&"break"!==t(n);n++);return window.next_fetched_page++,window.next_fetched_page<i&&console.log("Next page to fetch: ".concat(window.next_fetched_page)),Promise.allSettled(e)},r.classList.add("loading"),t.next=4,n(window.next_fetched_page);case 4:console.log("Fetched posts in first query: ".concat(S.length)),console.log(S),(o={fetched_list:JSON.stringify(S),action:"".concat(e.fetch_action)})[e.fetch_nonce_name]=e.fetch_nonce_value,jQuery.post(ajaxurl,o,"json").done((function(e){q(e),D.call(u,e),r.classList.remove("loading"),v.classList.add("inactive")})).fail((function(e){d.insertAdjacentHTML("afterbegin",y),console.log(e)}));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function D(t){this.insertAdjacentHTML("beforeend",t),N();var s=j();k&&!n.querySelector(".wdss-button.load-more")&&(v.insertAdjacentHTML("beforebegin",'<button type="button" class="wdss-button load-more">Fetch next page</button>'),(o=n.querySelector(".wdss-button.load-more")).classList.add("inactive")),window.next_fetched_page<i&&(o&&o.classList.remove("inactive"),m.classList.remove("inactive"),f.classList.remove("inactive"),o.addEventListener("click",(function(){!function(){m.addEventListener("click",T),q(),o.classList.add("inactive"),r.classList.add("loading"),m.classList.add("inactive"),f.classList.add("inactive");try{fetch(window.location.origin+"/wp-json/wp/v2/posts/?per_page=50&page=".concat(window.next_fetched_page)).then((function(e){if(e.status>=200&&e.status<300)return e.json();d.insertAdjacentHTML("afterbegin",y),f.classList.add("inactive"),m.classList.add("inactive")})).then((function(t){console.log(t);var s={fetched_list:JSON.stringify(t),action:e.fetch_action};s[e.fetch_nonce_name]=e.fetch_nonce_value,jQuery.post(ajaxurl,s,"json").done((function(e){console.log("Current fetched page: ".concat(window.next_fetched_page)),window.next_fetched_page++,window.next_fetched_page<i&&console.log("Next page to fetch: ".concat(window.next_fetched_page));var t=Array.from(n.querySelectorAll(".msg"));t&&t.forEach((function(e){return e.remove()})),r.classList.remove("loading"),window.next_fetched_page<i?(o.classList.remove("inactive"),m.classList.remove("inactive"),f.classList.remove("inactive")):(m.classList.remove("inactive"),f.classList.remove("inactive")),e?(u.insertAdjacentHTML("beforeend",e),q(e)):(document.querySelector(".wdss-modal-not-found-msg")||d.insertAdjacentHTML("afterbegin",_),m.classList.add("inactive"),f.classList.add("inactive")),N()})).fail((function(e){d.insertAdjacentHTML("afterbegin",y),console.log(e)}))}))}catch(e){console.log(e)}}()}))),s.length>0?(s.forEach((function(e){e.addEventListener("click",(function(){var t,n=e.querySelector('.wdss-table-post__select input[type="checkbox"]');n.hasAttribute("checked")?((t=n).removeAttribute("checked"),t.checked=!1):l(n)}))})),v.classList.add("inactive"),f.classList.remove("inactive"),m.classList.remove("inactive"),m.addEventListener("click",T)):(d.insertAdjacentHTML("afterbegin",_),m.classList.add("inactive"),f.classList.add("inactive")),f.addEventListener("click",(function(t){t.preventDefault(),A.confirm("Are you ready to start?").then((function(t){if(!0===t){var s,c=Array.from(n.querySelectorAll('.wdss-table-post__select input[type="checkbox"]:checked')),i=[];if(c.length){v.classList.remove("inactive"),c.forEach((function(e){i.push(e.value)})),s=i.join(","),console.log("Selected IDs: ".concat(s)),f.classList.add("inactive"),m.classList.add("inactive"),p.classList.remove("active"),h.innerHTML="",Array.from(n.querySelectorAll(".wdss-table-row.post")).forEach((function(e){e.parentNode.removeChild(e)}));var a={selected_list:JSON.stringify(s),action:e.post_action};a[e.post_nonce_name]=e.post_nonce_value,v.classList.add("inactive"),o&&o.classList.add("inactive"),r.classList.add("processing"),jQuery.post(ajaxurl,a,"json").done((function(e){console.log(e),d.insertAdjacentHTML("afterbegin",'<span class="msg successful">Completed!<br><small>It can take several minutes while changes are implementing</small></span>'),d.classList.add("active"),o&&o.classList.remove("inactive")})).fail((function(e){d.insertAdjacentHTML("afterbegin",y),console.log(e)})).always((function(){r.classList.remove("processing")}))}else A.info("Please, select the posts which will be proceded")}}))}))}w.childNodes.length<1&&w.insertAdjacentHTML("afterbegin",b),!0===window["".concat(e.fetch_action,"-setup")]?(A.prompt("Enter max posts per fetch count. The minimum is 50: ",(function(o){console.log(o);var s="<small>Lite-mode: max ".concat(a=o>=50?o:800," posts per fetches</small>");Number(c)>Number(a)&&(k=!0,w&&w.insertAdjacentHTML("beforeend",s)),k&&(c=a),window.next_fetched_page=Math.ceil(c/50),n.classList.add("active"),t.classList.add("fixed"),window["".concat(e.fetch_action,"-setup")]=!1})),console.log("Total fetchable pages: ".concat(i))):A.info("Please, reload the page first"),s.addEventListener("click",x),document.onkeydown=function(e){return"Esc"===e.key||"Escape"===e.key?x():null},v.addEventListener("click",(function(){var e=n.querySelector(".msg");e&&e.remove(),v.classList.add("inactive"),g.classList.remove("active"),q(),console.log("Current fetched pages: ".concat(window.next_fetched_page)),window.next_fetched_page=Math.ceil(c/50),function(){I.apply(this,arguments)}()}))}))}function j(e,t,n,o,s,c,i){try{var a=e[c](i),r=a.value}catch(e){return void n(e)}a.done?t(r):Promise.resolve(r).then(o,s)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(o,s){var c=e.apply(t,n);function i(e){j(c,o,s,i,a,"next",e)}function a(e){j(c,o,s,i,a,"throw",e)}i(void 0)}))}}String.prototype.stripSlashes=function(){return this.replace(/\\(.)/gm,"$1")};var T=new n;function I(e){var t=document.querySelector(e.root_el),n=t.querySelector(".wdss-button.wdss-table-add"),o=t.querySelector(".save-dictionary"),c=document.querySelector("#wdss-settings-page form"),a=t.querySelector(".wdss-table-handler .wdss-table tbody"),r=t.querySelector('input[type="text"]'),l=jQuery("".concat(e.root_el," .wdss-table tbody tr")),d=[];function u(){return(u=N(regeneratorRuntime.mark((function t(n){var c,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=jQuery("".concat(e.root_el," .wdss-table tbody tr")),i=[],jQuery.each(c,(function(){i.push(this.id)})),s(d,i)&&(a=!0),a||o.classList.contains("saved")||confirm("All unsaved changes will be lost. Do you want to continue?")||n.preventDefault();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}jQuery.each(l,(function(){d.push(this.id)})),o.addEventListener("click",(function(){var n=jQuery("".concat(e.root_el," .wdss-table-handler .wdss-table tbody tr")),s=[];n.each((function(e,t){var n=t.querySelector("td:nth-of-type(1)").textContent;s.push(n)}));var c={action:e.action,security:e.nonce};c[e.name]=s,jQuery.ajax({url:wdss_localize.url,type:"post",dataType:"json",data:c,success:function(){var e=t.querySelector(".wdss-table-actions span");e&&e.remove(),o.insertAdjacentHTML("afterend",'<span class="msg successful">Table was updated</span>'),i(t.querySelector("span.msg"),1200),o.classList.add("saved")},fail:function(e){var n=t.querySelector(".wdss-table-actions span");n&&n.remove(),o.insertAdjacentHTML("afterend",'<span class="msg error">Error, look at information in console</span>'),i(t.querySelector("span.msg"),1200),console.log(e)}})})),n.addEventListener("click",(function(){if(r.value){o.classList.remove("saved");var e=r.value;r.value="",a.insertAdjacentHTML("beforeend",'\n      <tr id="'.concat(wdss_localize.wp_rand,'">\n        <td>').concat(e,'</td>\n        <td class="wdss-table__remove-item"><i class="fas fa-trash"></i></td>\n      </tr>\n      '))}})),jQuery(document).on("click","".concat(e.root_el," .wdss-table__remove-item i"),(function(){var e=this;o.classList.remove("saved"),T.confirm("Remove this rule from table?").then((function(t){!0===t&&e.closest("tr").remove()}))})),c.addEventListener("submit",(function(e){return u.apply(this,arguments)}))}var D=document.querySelector("#wdss-settings-page");document.addEventListener("DOMContentLoaded",(function(){var e,t,n;D&&(document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings) > .wdss-row").forEach((function(e){e.classList.contains("pinned")||e.classList.add("hidden");var t=e.previousElementSibling,n=t.querySelectorAll(".section-toggler");function o(){t.classList.toggle("active"),e.classList.toggle("hidden")}n&&n.forEach((function(e){e.addEventListener("click",o)}))})),function(){var e=document.querySelectorAll(".wdss-section .section-pin"),t=document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings)");function n(){var e,t,n,o=this.closest(".wdss-section-header"),s=o.closest(".wdss-section").getAttribute("id");(JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[]).includes(s)?(this.classList.remove("active"),o.querySelector("h2").classList.remove("pinned"),o.querySelector("i.section-toggler").classList.remove("disabled"),e=s,-1!==(n=(t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[]).indexOf(e))&&t.splice(n,1),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))):(this.classList.add("active"),o.classList.add("active"),function(e){var t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[];t.push(e),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))}(s),o.querySelector("h2").classList.add("pinned"),o.querySelector("i.section-toggler").classList.add("disabled"))}!function(){var e;localStorage.getItem("PINNED_WDS_SECTIONS")?e=localStorage.getItem("PINNED_WDS_SECTIONS"):(e=[],localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(e)));var n=e;t.forEach((function(e){var t=e.getAttribute("id"),o=e.querySelector(".wdss-section-header"),s=o.nextElementSibling;n.includes(t)&&(e.classList.add("pinned"),o.querySelector("i.section-pin").classList.add("active"),o.querySelector("i.section-toggler").classList.add("disabled"),o.classList.add("active"),o.querySelector("h2").classList.add("pinned"),s.classList.remove("hidden"))}))}(),e.forEach((function(e){e.addEventListener("click",n)}))}(),wdss_localize.total_post_count>0&&(a(d),c(h),S(v),r(f),x(w),x(b)),wdss_localize.is_polylang_exists&&wdss_localize.is_polylang_setup&&a(u),I(y),I(_),S(p),r(m),e=document.querySelector("#wdss-advanced-jsonld-schema-condition input"),t=document.querySelector(".wdss-jsonld-schema-predifined-settings"),e.hasAttribute("checked")&&t.classList.add("disabled"),e.addEventListener("click",(function(){t.classList.contains("disabled")?t.classList.remove("disabled"):t.classList.add("disabled")})),c(g),Array.from(document.querySelectorAll('input[type="checkbox"')).forEach((function(e){e.addEventListener("click",(function(){e.hasAttribute("checked")?(e.removeAttribute("checked"),e.value=0,e.checked=!1):(e.setAttribute("checked","checked"),e.checked=!0,e.value=1)}))})),n=Array.from(document.querySelectorAll("#wdss-snippets-settings input")),document.querySelector("#wdss-toggle-options").addEventListener("click",(function(){n[0].hasAttribute("checked")?n.forEach((function(e){e.removeAttribute("checked"),e.checked=!1})):n.forEach((function(e){e.setAttribute("checked","checked"),e.checked=!0}))})),Array.from(document.querySelectorAll(".wdss-setting-item-accordion")).forEach((function(e){var t=e.nextElementSibling;e.addEventListener("click",(function(){t.classList.contains("active")?(e.classList.remove("opened"),t.classList.remove("active")):(e.classList.add("opened"),t.classList.add("active"))}))})))}))})();