(()=>{"use strict";function e(e){e&&document.querySelector(e.selector)&&document.querySelector(e.selector).addEventListener("click",(function(){var t=document.querySelector(e.input),n="";switch(e.input){case"#wdss-jsonld-schema-orgname input":n=wdss_localize.site_name;break;case"#wdss-jsonld-schema-email input":n=wdss_localize.site_email}t.value=n}))}var t=function(e,t){setTimeout((function(){e.remove()}),t)};function n(e){var t=document.querySelector(e.toggler),n=t.hasAttribute("checked"),o=document.querySelector(e.target);n&&o.classList.toggle("hidden"),t.addEventListener("click",(function(){o.classList.toggle("hidden")}))}function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){Array.from(document.querySelectorAll(e.button)).forEach((function(t){t.addEventListener("click",(function(){var n=t.closest("div").querySelector(e.target);""!==n.value&&confirm("Are you sure?")&&(n.value="")}))}))}))}function s(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",s=arguments.length>2?arguments[2]:void 0,c=document.querySelector("html");switch(o){case"info":n="info";break;case"prompt":n="prompt"}function a(){this.closest(".notification").remove(),"prompt"===o&&c.classList.remove("fixed")}if("prompt"===o&&c.classList.add("fixed"),t='\n    <div class="modal notification '.concat(n,'">\n    <div class="notification-header">\n      <i class="fas fa-times"></i>\n    </div>\n    <div class="notification-content">\n    <span>').concat(e,"</span>\n    </div>"),"prompt"===o&&(c.classList.add("fixed"),t+='<div class="notification-content-inputs"><input required type="number" min="100" value="100"><button type="button" class="wdss-button">Enter</button></div>'),t+="</div>",document.body.insertAdjacentHTML("beforeend",t),document.querySelector(".modal.notification")){var i=document.querySelector(".modal.notification"),r=i.querySelector("i");if(r.addEventListener("click",a),"prompt"===o&&document.querySelector(".notification-content-inputs")){var l=document.querySelector(".notification-content-inputs"),d=l.querySelector("input"),u=l.querySelector("button");d.value&&u.addEventListener("click",(function(){s(d.value),i.remove()}))}}}function c(e){e.setAttribute("checked","checked"),e.checked=!0}function a(e){e.removeAttribute("checked"),e.checked=!1}var i={toggler:"#wdss-auto-featured-image-condition input",target:"#wdss-featured-images-group"},r={toggler:"#wdss-polylang-meta-data-condition input",target:"#wdss-polylang-meta-data-group"},l={button:"#wdss-featured-images-group button.reset",target:"#wdss-featured-images-group input"},d={button:"#wdss-jsonld-schema-logo button.reset",target:"#wdss-jsonld-schema-logo input"},u={select:".image-chooser.featured button.choose",target:".image-chooser.featured input",is_multiple:!0,title:"Select Featured Images"},f={select:".image-chooser.logo button.choose",target:".image-chooser.logo input",is_multiple:!1,title:"Select Organization Logo"},m={selector:"#wdss-generate-orgname",input:"#wdss-jsonld-schema-orgname input"},p={selector:"#wdss-generate-email",input:"#wdss-jsonld-schema-email input"},v={root_el:"#custom-410s-list-settings",action:"e410_dictionary_update",nonce:"e410-dictionary-nonce",name:"e410_dictionary"},h={root_el:"#images-settings",action:"excluded_hosts_dictionary_update",nonce:"excluded-hosts-dictionary-nonce",name:"excluded_hosts_dictionary"},g={modal_el:"#exclude-posts-modal",open_modal_btn:"#wdss-remove-broken-featured__choose",fetch_action:"fetch_broken_featured",fetch_nonce_name:"fetch_broken_featured_nonce",fetch_nonce_value:wdss_localize.broken_featured_list_nonce,post_action:"remove_broken_featured",post_nonce_name:"remove_broken_featured_nonce",post_nonce_value:wdss_localize.remove_broken_featured_nonce};function _(e){Array.from(document.querySelectorAll(e.select)).forEach((function(t){t.addEventListener("click",(function(n){var o;n.preventDefault(),(o=wp.media({title:e.title,multiple:e.is_multiple,library:{type:"image"},button:{text:"Select"}})).on("close",(function(){var n=t.closest(".image-chooser.featured"),s=t.closest(".image-chooser.logo"),c=o.state().get("selection"),a=new Array,i=new Array,r=0;if(n){c.forEach((function(e){a[r]=e.id,r++}));var l=a.join(",");n.querySelector(e.target).value=l}else if(s){c.forEach((function(e){i[r]=e.attributes.url,r++}));var d=i.join(",");s.querySelector(e.target).value=d}})),o.on("open",(function(){var n=t.closest(".wdss-setting-item.image-chooser"),s=o.state().get("selection");n.querySelector(e.target).value.split(",").forEach((function(e){var t=wp.media.attachment(e);t.fetch(),s.add(t?[t]:[])}))})),o.open()}))}))}function y(e,t,n,o,s,c,a){try{var i=e[c](a),r=i.value}catch(e){return void n(e)}i.done?t(r):Promise.resolve(r).then(o,s)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(o,s){var c=e.apply(t,n);function a(e){y(c,o,s,a,i,"next",e)}function i(e){y(c,o,s,a,i,"throw",e)}a(void 0)}))}}function S(e){var n=document.querySelector(e.root_el),o=n.querySelector(".wdss-list-item-handler.add"),s=n.querySelector(".save-dictionary"),c=document.querySelector("#wdss-settings-page form"),a=n.querySelector(".wdss-list-table tbody"),i=n.querySelector('input[type="text"]'),r=jQuery("".concat(e.root_el," .wdss-list-table tbody tr")),l=[];jQuery.each(r,(function(){l.push(this.id)})),s.addEventListener("click",(function(){var o=jQuery("".concat(e.root_el," .wdss-list-table tbody tr")),c=[];o.each((function(e,t){var n=t.querySelector("td:nth-of-type(1)").textContent;c.push(n)}));var a={action:e.action,security:e.nonce};a[e.name]=c,jQuery.ajax({url:wdss_localize.url,type:"post",dataType:"json",data:a,success:function(e){var o=n.querySelector(".wdss-list-table-actions span");o&&o.remove(),s.insertAdjacentHTML("afterend",'<span class="msg successful">Table was updated</span>'),t(n.querySelector("span.msg"),1200),s.classList.add("saved")},fail:function(e){var o=n.querySelector(".wdss-list-table-actions span");o&&o.remove(),s.insertAdjacentHTML("afterend",'<span class="msg error">Error, look at information in console</span>'),t(n.querySelector("span.msg"),1200),console.log(e)}})})),o.addEventListener("click",(function(){if(i.value){s.classList.remove("saved");var e=i.value;i.value="",a.insertAdjacentHTML("beforeend",'\n      <tr id="'.concat(wdss_localize.wp_rand,'">\n        <td>').concat(e,'</td>\n        <td class="wdss-list-table__remove-item"><i class="fas fa-trash"></i></td>\n      </tr>\n      '))}})),jQuery(document).on("click","".concat(e.root_el," .wdss-list-table__remove-item i"),(function(){s.classList.remove("saved"),confirm("Remove this rule from table?")&&this.closest("tr").remove()})),c.addEventListener("submit",(function(t){var n,o=jQuery("".concat(e.root_el," .wdss-list-table tbody tr")),c=[];jQuery.each(o,(function(){c.push(this.id)})),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!t.includes(e[n]))return!1;return!0}(l,c)&&(n=!0),n||s.classList.contains("saved")||confirm("All unsaved changes will be lost. Do you want to continue?")||t.preventDefault()}))}var L=document.querySelector("#wdss-settings-page");document.addEventListener("DOMContentLoaded",(function(){var t,y,b,q,E,k,A,x,j,N;L&&(document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings) > .wdss-row").forEach((function(e){e.classList.contains("pinned")||e.classList.add("hidden");var t=e.previousElementSibling,n=t.querySelectorAll(".section-toggler");function o(){t.classList.toggle("active"),e.classList.toggle("hidden")}n&&n.forEach((function(e){e.addEventListener("click",o)}))})),function(){var e=document.querySelectorAll(".wdss-section .section-pin"),t=document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings)");function n(){var e,t,n,o=this.closest(".wdss-section-header"),s=o.closest(".wdss-section").getAttribute("id");(JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[]).includes(s)?(this.classList.remove("active"),o.querySelector("h2").classList.remove("pinned"),o.querySelector("i.section-toggler").classList.remove("disabled"),e=s,-1!==(n=(t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[]).indexOf(e))&&t.splice(n,1),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))):(this.classList.add("active"),o.classList.add("active"),function(e){var t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[];t.push(e),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))}(s),o.querySelector("h2").classList.add("pinned"),o.querySelector("i.section-toggler").classList.add("disabled"))}!function(){var e;localStorage.getItem("PINNED_WDS_SECTIONS")?e=localStorage.getItem("PINNED_WDS_SECTIONS"):(e=[],localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(e)));var n=e;t.forEach((function(e){var t=e.getAttribute("id"),o=e.querySelector(".wdss-section-header"),s=o.nextElementSibling;n.includes(t)&&(e.classList.add("pinned"),o.querySelector("i.section-pin").classList.add("active"),o.querySelector("i.section-toggler").classList.add("disabled"),o.classList.add("active"),o.querySelector("h2").classList.add("pinned"),s.classList.remove("hidden"))}))}(),e.forEach((function(e){e.addEventListener("click",n)}))}(),wdss_localize.total_post_count>0&&(n(i),e(m),_(u),o(l),q=g,E=document.querySelector("html"),k=document.querySelector(q.modal_el),A=document.querySelector(q.open_modal_btn),x=k.querySelector(".wdss-modal-header i.fa-times"),j=wdss_localize.total_post_count,N=Math.ceil(j/100),window.is_setup_stage=!0,A&&A.addEventListener("mousedown",(function(){var e,t,n=k.querySelector(".wdss-modal-body"),o=k.querySelector(".wdss-modal-informaion-panel"),i=document.querySelector("#wdss-exclude-posts-table tbody"),r=k.querySelector(".wdss-button.submit"),l=k.querySelector(".wdss-button.toggle-all"),d=k.querySelector(".wdss-button.get-posts"),u=k.querySelector(".wdss-modal-posts-count"),f=u.querySelector("strong"),m=k.querySelector(".wdss-modal-welcome-msg"),p='<span class="wdss-modal-not-found-msg">No results...</span>',v=k.querySelector(".wdss-modal-title"),h=[],g=!1;function _(){k.classList.remove("active"),E.classList.remove("fixed"),Array.from(document.querySelectorAll(".notification")).forEach((function(e){e.remove()}))}function y(){return Array.from(document.querySelectorAll(".wdss-table-row.post"))}function S(){var e=y().length;if(u.classList.add("active"),f)return f.innerHTML=e}function L(){y().forEach((function(e){var t=e.querySelector('.wdss-table-post__select input[type="checkbox"]');t.hasAttribute("checked")?a(t):c(t)}))}function b(){return(b=w(regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){for(var e=[],t=function(t){try{e.push(new Promise((function(e,n){fetch(document.location.origin+"/wp-json/wp/v2/posts?per_page=100&page=".concat(t)).then((function(e){return e.json()})).then((function(t){h=h.concat(t),e()})).catch((function(e){console.log(e),n()}))})))}catch(e){return"break"}},n=1;n<=window.next_fetched_page&&"break"!==t(n);n++);return window.next_fetched_page++,window.next_fetched_page<N?console.log("Next page to fetch: ".concat(window.next_fetched_page)):console.log("This is the last page to fetch"),Promise.allSettled(e)},n.classList.add("loading"),e.next=4,t(window.next_fetched_page);case 4:console.log("Fetched posts in first query: ".concat(h.length)),(o={fetched_list:JSON.stringify(h),action:q.fetch_action})[q.fetch_nonce_name]=q.fetch_nonce_value,jQuery.ajax({url:wdss_localize.url,type:"post",data:o,success:function(e){A.call(i,e),n.classList.remove("loading"),d.classList.add("inactive")}});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(t){this.insertAdjacentHTML("beforeend",t),S();var m=y();g&&!k.querySelector(".wdss-button.load-more")&&(d.insertAdjacentHTML("beforebegin",'<button type="button" class="wdss-button load-more">Fetch next page</button>'),e=k.querySelector(".wdss-button.load-more")),e&&e.addEventListener("click",(function(){!function(){if(l.addEventListener("click",L),N===window.next_fetched_page)return s("You achived the last page","info"),void e.classList.add("inactive");var t=k.querySelector(".wdss-modal-not-found-msg");t&&t.remove(),e.classList.add("inactive"),n.classList.add("loading"),l.classList.add("inactive"),r.classList.add("inactive");try{fetch(document.location.origin+"/wp-json/wp/v2/posts?per_page=100&page=".concat(window.next_fetched_page)).then((function(e){return e.json()})).then((function(s){var c={fetched_list:JSON.stringify(s),action:q.fetch_action};c[q.fetch_nonce_name]=q.fetch_nonce_value,jQuery.ajax({url:wdss_localize.url,type:"post",data:c,success:function(s){console.log("Current fetched page: ".concat(window.next_fetched_page)),window.next_fetched_page++,window.next_fetched_page<N?console.log("Next page to fetch: ".concat(window.next_fetched_page)):console.log("This is the last page to fetch");var c=Array.from(k.querySelectorAll(".msg"));c&&c.forEach((function(e){return e.remove()})),n.classList.remove("loading"),e.classList.remove("inactive"),l.classList.remove("inactive"),r.classList.remove("inactive"),s?(i.insertAdjacentHTML("beforeend",s),t&&t.remove()):(o.insertAdjacentHTML("afterbegin",p),l.classList.add("inactive"),r.classList.add("inactive")),S()}})}))}catch(e){console.log(e)}}()})),m.length>0?(m.forEach((function(e){e.addEventListener("click",(function(){var t=e.querySelector('.wdss-table-post__select input[type="checkbox"]');t.hasAttribute("checked")?a(t):c(t)}))})),d.classList.add("inactive"),r.classList.remove("inactive"),l.classList.remove("inactive"),l.addEventListener("click",L)):(o.insertAdjacentHTML("afterbegin",p),l.classList.add("inactive"),r.classList.add("inactive")),r.addEventListener("click",(function(){var e,t=Array.from(k.querySelectorAll('.wdss-table-post__select input[type="checkbox"]:checked')),n=[];if(t.length){if(confirm("Are you ready to start?")){d.classList.remove("inactive"),t.forEach((function(e){n.push(e.value)})),e=n.join(","),console.log("Selected IDs: ".concat(e)),r.classList.add("inactive"),l.classList.add("inactive"),u.classList.remove("active"),f.innerHTML="",Array.from(k.querySelectorAll(".wdss-table-row.post")).forEach((function(e){e.parentNode.removeChild(e)}));var c={selected_list:JSON.stringify(e),action:q.post_action};c[q.post_nonce_name]=q.post_nonce_value,jQuery.ajax({url:wdss_localize.url,type:"post",data:c,success:function(){d.classList.add("inactive"),o.insertAdjacentHTML("afterbegin",'<span class="msg successful">Completed!<br><small>Please wait several minutes while changes are implementing</small></span>')},error:function(e){o.insertAdjacentHTML("afterbegin",'<span class="msg error">An Error occured!<br><smallLook in console for more details</small></span>'),console.log(e)}})}}else s("Please, select the posts which will be proceded","info")}))}v.childNodes.length<1&&v.insertAdjacentHTML("afterbegin","Delete Broken Featured Images"),void 0===window.next_fetched_page?(s("Enter max posts per fetch count. The minimum is 100: ","prompt",(function(e){var n="<small>Lite-mode: max ".concat(t=e>=100?e:800," posts per fetches</small>");j>t&&(g=!0,v&&v.insertAdjacentHTML("beforeend",n)),g&&(j=t),window.next_fetched_page=Math.ceil(j/100),k.classList.add("active"),E.classList.add("fixed")})),console.log("Total fetchable pages: ".concat(N))):s("Please, reload the page first","info"),x.addEventListener("click",_),document.onkeydown=function(e){return"Esc"===e.key||"Escape"===e.key?_():null},d.addEventListener("click",(function(){var e=k.querySelector(".msg");e&&e.remove(),d.classList.add("inactive"),m.classList.remove("active");var t=k.querySelector(".wdss-modal-not-found-msg");t&&t.remove(),console.log("Current fetched pages: ".concat(window.next_fetched_page)),window.next_fetched_page=Math.ceil(j/100),function(){b.apply(this,arguments)}()}))}))),wdss_localize.is_polylang_exists&&wdss_localize.is_polylang_setup&&n(r),S(v),S(h),_(f),o(d),t=document.querySelector("#wdss-advanced-jsonld-schema-condition input"),y=document.querySelector(".wdss-jsonld-schema-predifined-settings"),t.hasAttribute("checked")&&y.classList.add("disabled"),t.addEventListener("click",(function(){y.classList.contains("disabled")?y.classList.remove("disabled"):y.classList.add("disabled")})),e(p),Array.from(document.querySelectorAll('input[type="checkbox"')).forEach((function(e){e.addEventListener("click",(function(){e.hasAttribute("checked")?(e.removeAttribute("checked"),e.value=0,e.checked=!1):(e.setAttribute("checked","checked"),e.checked=!0,e.value=1)}))})),b=Array.from(document.querySelectorAll("#wdss-snippets-settings input")),document.querySelector("#wdss-toggle-options").addEventListener("click",(function(){b[0].hasAttribute("checked")?b.forEach((function(e){e.removeAttribute("checked"),e.checked=!1})):b.forEach((function(e){e.setAttribute("checked","checked"),e.checked=!0}))})),Array.from(document.querySelectorAll(".wdss-setting-item-accordion")).forEach((function(e){var t=e.nextElementSibling;e.addEventListener("click",(function(){t.classList.contains("active")?(e.classList.remove("opened"),t.classList.remove("active")):(e.classList.add("opened"),t.classList.add("active"))}))})))}))})();